!function(){var t=new(function(){var t;function e(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t?JSON.parse(JSON.stringify(t)):[,,,,].fill(null).map(function(){return[,,,,].fill(0)}),this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle",t||(this.addRandomTile(),this.addRandomTile())}return t=[{key:"moveLeft",value:function(){var t=this;"playing"===this.status&&(this.board=this.board.map(function(e){return t.slideAndMerge(e)}),this.finalizeMove())}},{key:"moveRight",value:function(){var t=this;"playing"===this.status&&(this.board=this.board.map(function(e){return t.slideAndMerge(e.reverse()).reverse()}),this.finalizeMove())}},{key:"moveUp",value:function(){var t=this;this.transpose(),this.board=this.board.map(function(e){return t.slideAndMerge(e)}),this.transpose(),this.finalizeMove()}},{key:"moveDown",value:function(){var t=this;this.transpose(),this.board=this.board.map(function(e){return t.slideAndMerge(e.reverse()).reverse()}),this.transpose(),this.finalizeMove()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.board))}},{key:"getStatus",value:function(){return"win"===this.status?"win":this.noMovesLeft()?"lose":"playing"}},{key:"start",value:function(){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateBoard()}},{key:"restart",value:function(){this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle",this.updateBoard()}},{key:"updateBoard",value:function(){var t=this;document.querySelectorAll(".field-cell").forEach(function(e,i){var r=Math.floor(i/4),a=t.board[r][i%4];e.textContent=0===a?"":a,e.className="field-cell ".concat(a?"field-cell--".concat(a):"")})}},{key:"addRandomTile",value:function(){var t=[];if(this.board.forEach(function(e,i){e.forEach(function(e,r){0===e&&t.push({row:i,col:r})})}),t.length>0){var e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}}},{key:"slideAndMerge",value:function(t){for(var e=t.filter(function(t){return 0!==t}),i=[],r=0;r<e.length;)e[r]===e[r+1]?(i.push(2*e[r]),this.score+=2*e[r],r+=2):(i.push(e[r]),r++);for(;i.length<4;)i.push(0);return i}},{key:"transpose",value:function(){for(var t=[,,,,].fill(null).map(function(){return[,,,,].fill(0)}),e=0;e<4;e++)for(var i=0;i<4;i++)t[i][e]=this.board[e][i];this.board=t}},{key:"finalizeMove",value:function(){var t=JSON.stringify(this.board);this.addRandomTile(),this.updateBoard(),this.board.flat().includes(2048)?this.status="win":this.noMovesLeft()&&JSON.stringify(this.board)===t&&(this.status="lose")}},{key:"noMovesLeft",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(0===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return!1;return!0}}],function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(e.prototype,t),e}()),e=document.querySelector(".button.start"),i=document.querySelector(".message-start"),r=document.querySelector(".message-win"),a=document.querySelector(".message-lose"),s=document.querySelector(".game-score");function n(){t.updateBoard(),s.textContent=t.getScore(),"win"===t.getStatus()?(r.classList.remove("hidden"),a.classList.add("hidden"),e.textContent="Restart"):"lose"===t.getStatus()?(a.classList.remove("hidden"),r.classList.add("hidden"),e.textContent="Restart"):(r.classList.add("hidden"),a.classList.add("hidden"))}e.addEventListener("click",function(){t.restart(),t.start(),n(),e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),i.classList.add("hidden")}),document.addEventListener("keydown",function(e){var i=e.key;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(i)){switch(i){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}n()}})}();
//# sourceMappingURL=index.723eafc0.js.map
