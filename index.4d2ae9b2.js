const t=new class{constructor(t){this.initialState=t?JSON.parse(JSON.stringify(t)):[,,,,].fill(null).map(()=>[,,,,].fill(0)),this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle",t||(this.addRandomTile(),this.addRandomTile())}moveLeft(){"playing"===this.status&&(this.board=this.board.map(t=>this.slideAndMerge(t)),this.finalizeMove())}moveRight(){"playing"===this.status&&(this.board=this.board.map(t=>this.slideAndMerge(t.reverse()).reverse()),this.finalizeMove())}moveUp(){this.transpose(),this.board=this.board.map(t=>this.slideAndMerge(t)),this.transpose(),this.finalizeMove()}moveDown(){this.transpose(),this.board=this.board.map(t=>this.slideAndMerge(t.reverse()).reverse()),this.transpose(),this.finalizeMove()}getScore(){return this.score}getState(){return JSON.parse(JSON.stringify(this.board))}getStatus(){return"win"===this.status?"win":this.noMovesLeft()?"lose":"playing"}start(){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.updateBoard()}restart(){this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle",this.updateBoard()}updateBoard(){document.querySelectorAll(".field-cell").forEach((t,e)=>{let s=Math.floor(e/4),i=this.board[s][e%4];t.textContent=0===i?"":i,t.className=`field-cell ${i?`field-cell--${i}`:""}`})}addRandomTile(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,i)=>{0===e&&t.push({row:s,col:i})})}),t.length>0){let e=t[Math.floor(Math.random()*t.length)];this.board[e.row][e.col]=.9>Math.random()?2:4}}slideAndMerge(t){let e=t.filter(t=>0!==t),s=[],i=0;for(;i<e.length;)e[i]===e[i+1]?(s.push(2*e[i]),this.score+=2*e[i],i+=2):(s.push(e[i]),i++);for(;s.length<4;)s.push(0);return s}transpose(){let t=[,,,,].fill(null).map(()=>[,,,,].fill(0));for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[s][e]=this.board[e][s];this.board=t}finalizeMove(){let t=JSON.stringify(this.board);this.addRandomTile(),this.updateBoard(),this.board.flat().includes(2048)?this.status="win":this.noMovesLeft()&&JSON.stringify(this.board)===t&&(this.status="lose")}noMovesLeft(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return!1;return!0}},e=document.querySelector(".button.start"),s=document.querySelector(".message-start"),i=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),a=document.querySelector(".game-score");function o(){t.updateBoard(),a.textContent=t.getScore(),"win"===t.getStatus()?(i.classList.remove("hidden"),r.classList.add("hidden"),e.textContent="Restart"):"lose"===t.getStatus()?(r.classList.remove("hidden"),i.classList.add("hidden"),e.textContent="Restart"):(i.classList.add("hidden"),r.classList.add("hidden"))}e.addEventListener("click",()=>{t.restart(),t.start(),o(),e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart"),s.classList.add("hidden")}),document.addEventListener("keydown",e=>{let s=e.key;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(s)){switch(s){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}o()}});
//# sourceMappingURL=index.4d2ae9b2.js.map
